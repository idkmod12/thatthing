-- SERVICES
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")

local localPlayer = Players.LocalPlayer

-- UI SETUP

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UserSpammerGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = localPlayer:WaitForChild("PlayerGui")

-- TAB BAR FRAME (fixed top, full width)
local TabBar = Instance.new("Frame")
TabBar.Name = "TabBar"
TabBar.Parent = ScreenGui
TabBar.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
TabBar.Size = UDim2.new(1, 0, 0, 36)
TabBar.Position = UDim2.new(0,0,0,0)
TabBar.BorderSizePixel = 0

local TabBarUICorner = Instance.new("UICorner", TabBar)
TabBarUICorner.CornerRadius = UDim.new(0, 6)

-- Content Frame (draggable, below TabBar)
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = ScreenGui
ContentFrame.Size = UDim2.new(0, 640, 0, 360)
ContentFrame.Position = UDim2.new(0.5, -320, 0, 40)
ContentFrame.BackgroundColor3 = Color3.fromRGB(20, 15, 40)
ContentFrame.BorderSizePixel = 0
ContentFrame.Active = true
ContentFrame.Draggable = true

local ContentUICorner = Instance.new("UICorner", ContentFrame)
ContentUICorner.CornerRadius = UDim.new(0, 12)

-- Title in ContentFrame top-left
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Parent = ContentFrame
TitleLabel.Position = UDim2.new(0, 10, 0, 10)
TitleLabel.Size = UDim2.new(1, -20, 0, 30)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextSize = 22
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.Text = "USER'S SS"

-- TAB BUTTONS SETUP

local Tabs = {"SpamStuff", "Players", "ChatEffects", "Workspace", "Skybox"}

local TabButtons = {}
local CurrentTab = nil

local function createTabButton(tabName, posX)
    local btn = Instance.new("TextButton")
    btn.Name = tabName .. "Button"
    btn.Parent = TabBar
    btn.Size = UDim2.new(0, 120, 1, -6)
    btn.Position = UDim2.new(0, posX, 0, 3)
    btn.BackgroundColor3 = Color3.fromRGB(70, 50, 120)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 18
    btn.TextColor3 = Color3.fromRGB(230, 230, 230)
    btn.Text = tabName
    btn.AutoButtonColor = true

    local uic = Instance.new("UICorner", btn)
    uic.CornerRadius = UDim.new(0, 6)

    btn.MouseButton1Click:Connect(function()
        -- Deselect all tabs
        for _, b in pairs(TabButtons) do
            b.BackgroundColor3 = Color3.fromRGB(70, 50, 120)
            b.TextColor3 = Color3.fromRGB(230,230,230)
        end
        -- Select this tab
        btn.BackgroundColor3 = Color3.fromRGB(150, 100, 220)
        btn.TextColor3 = Color3.fromRGB(255, 255, 255)
        CurrentTab = tabName
        TitleLabel.Text = "USER'S SS - " .. tabName
        updateContentForTab(tabName)
    end)

    return btn
end

-- CONTENT PANELS FOR EACH TAB (frames parented to ContentFrame)

local ContentPanels = {}

local function createContentPanel(name)
    local panel = Instance.new("Frame")
    panel.Name = name .. "Panel"
    panel.Parent = ContentFrame
    panel.Size = UDim2.new(1, -20, 1, -50)
    panel.Position = UDim2.new(0, 10, 0, 40)
    panel.BackgroundColor3 = Color3.fromRGB(30, 20, 50)
    panel.BorderSizePixel = 0
    panel.Visible = false

    local uic = Instance.new("UICorner", panel)
    uic.CornerRadius = UDim.new(0, 10)

    return panel
end

-- Create Tab Buttons and Content Panels
do
    local posX = 10
    for _, tabName in ipairs(Tabs) do
        TabButtons[tabName] = createTabButton(tabName, posX)
        ContentPanels[tabName] = createContentPanel(tabName)
        posX = posX + 130
    end
end

-- FUNCTION TO CLEAR ALL CONTENT PANELS
local function hideAllContent()
    for _, panel in pairs(ContentPanels) do
        panel.Visible = false
    end
end

-- BASE64 ENCODING/DECODING UTILITIES
local b='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'

local function base64Decode(data)
    data = string.gsub(data, '[^'..b..'=]', '')
    return (data:gsub('.', function(x)
        if (x == '=') then return '' end
        local r,f='',(b:find(x)-1)
        for i=6,1,-1 do r=r..(f%2^i - f%2^(i-1) > 0 and '1' or '0') end
        return r;
    end):gsub('%d%d%d%d%d%d%d%d', function(x)
        local c=0
        for i=1,8 do c=c + (x:sub(i,i)=='1' and 2^(8-i) or 0) end
        return string.char(c)
    end))
end

-- XOR decode utility
local function xorDecode(data, key)
    local res = {}
    for i=1, #data do
        local b = data:byte(i)
        local k = key:byte(((i-1) % #key) + 1)
        res[i] = string.char(bit32.bxor(b, k))
    end
    return table.concat(res)
end

-- DEEP OBFUSCATION for decal and particle asset IDs and URLs

local xorKey = "s3cr3tK3y"

-- Obfuscated base64+XOR strings for particle texture ID
local obfParticle = "KiUwAywVFksHKSYqFScEBw==" -- encoded and then XORed (will decode below)
-- Obfuscated base64+XOR strings for decal asset ID for skybox & decals
local obfDecal = "JiImHBoIISgbPhInHB8="

-- Decodes obfuscated base64+XOR string
local function decodeObf(str)
    local decodedBase64 = base64Decode(str)
    local decoded = xorDecode(decodedBase64, xorKey)
    return decoded
end

-- Particle Spam function
local function particleSpam()
    local particleId = decodeObf(obfParticle) or "70808795321734"
    for _, pl in pairs(Players:GetPlayers()) do
        if pl.Character and pl.Character:FindFirstChild("Head") then
            local emit = Instance.new("ParticleEmitter")
            emit.Parent = pl.Character.Head
            emit.Texture = "rbxassetid://"..particleId
            emit.VelocitySpread = 100000
        end
    end
end

-- Decal Spam function
local function decalSpam()
    local decalId = decodeObf(obfDecal) or "108493850623012"
    local decalUrl = "http://www.roblox.com/asset/?id=" .. decalId

    local function exPro(root)
        for _, v in pairs(root:GetChildren()) do
            if v:IsA("Decal") and v.Texture ~= decalUrl then
                pcall(function() v:Destroy() end)
            elseif v:IsA("BasePart") then
                v.Material = Enum.Material.Plastic
                v.Transparency = 0
                local faces = {"Front","Back","Right","Left","Top","Bottom"}
                for _, face in pairs(faces) do
                    local dec = Instance.new("Decal")
                    dec.Texture = decalUrl
                    dec.Face = Enum.NormalId[face]
                    dec.Parent = v
                end
            end
            pcall(function() exPro(v) end)
        end
    end
    exPro(Workspace)
end

-- Delete Terrain function
local function deleteTerrain()
    if Workspace:FindFirstChild("Terrain") then
        pcall(function() Workspace.Terrain:Clear() end)
    end
end

-- Skybox changer function
local function setSkybox()
    local sky = Instance.new("Sky")
    sky.Name = "Sky"
    sky.Parent = Lighting
    local decalId = decodeObf(obfDecal) or "108493850623012"
    local baseUrl = "http://www.roblox.com/asset/?id=" .. decalId
    sky.SkyboxBk = baseUrl
    sky.SkyboxDn = baseUrl
    sky.SkyboxFt = baseUrl
    sky.SkyboxLf = baseUrl
    sky.SkyboxRt = baseUrl
    sky.SkyboxUp = baseUrl
    Lighting.TimeOfDay = 12
end

-- BUTTON CREATION UTILITY
local function createButton(parent, text, posY, callback)
    local btn = Instance.new("TextButton")
    btn.Parent = parent
    btn.Size = UDim2.new(0, 200, 0, 35)
    btn.Position = UDim2.new(0, 20, 0, posY)
    btn.BackgroundColor3 = Color3.fromRGB(88, 36, 133)
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 18
    btn.Text = text
    btn.AutoButtonColor = true
    local cr = Instance.new("UICorner", btn)
    cr.CornerRadius = UDim.new(0, 6)
    btn.MouseButton1Click:Connect(callback)
    return btn
end

-- SETUP TAB CONTENTS

-- SpamStuff tab - Empty or placeholder
local function setupSpamStuffTab(panel)
    -- Can add spam stuff here if desired
end

-- Players tab content
local function setupPlayersTab(panel)
    local posY = 20
    createButton(panel, "Fast All WalkSpeed (50)", posY, function()
        for _, p in pairs(Players:GetPlayers()) do
            if p.Character and p.Character:FindFirstChildOfClass("Humanoid") then
                p.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = 50
            end
        end
    end)

    posY = posY + 50
    createButton(panel, "Normal WalkSpeed (16)", posY, function()
        for _, p in pairs(Players:GetPlayers()) do
            if p.Character and p.Character:FindFirstChildOfClass("Humanoid") then
                p.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = 16
            end
        end
    end)

    posY = posY + 50
    createButton(panel, "Slow WalkSpeed (5)", posY, function()
        for _, p in pairs(Players:GetPlayers()) do
            if p.Character and p.Character:FindFirstChildOfClass("Humanoid") then
                p.Character:FindFirstChildOfClass("Humanoid").WalkSpeed = 5
            end
        end
    end)

    posY = posY + 50
    createButton(panel, "First Person Others", posY, function()
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= localPlayer then
                p.CameraMode = Enum.CameraMode.LockFirstPerson
            end
        end
    end)

    posY = posY + 50
    createButton(panel, "Normal Camera Others", posY, function()
        for _, p in pairs(Players:GetPlayers()) do
            if p ~= localPlayer then
                p.CameraMode = Enum.CameraMode.Classic
            end
        end
    end)
end

-- ChatEffects tab content
local function setupChatEffectsTab(panel)
    local posY = 20
    createButton(panel, "Start Rainbow Chat", posY, function()
        local ChatWindowConfig = game:GetService("TextChatService"):FindFirstChild("ChatWindowConfiguration")
        if ChatWindowConfig then
            spawn(function()
                while true do
                    if not panel or not panel.Parent then break end
                    local hue = tick() % 1
                    ChatWindowConfig.BackgroundColor3 = Color3.fromHSV(hue, 1, 1)
                    ChatWindowConfig.TextColor3 = Color3.fromHSV((hue + 0.5) % 1, 1, 1)
                    wait(0.1)
                end
            end)
        end
    end)

    posY = posY + 50
    createButton(panel, "Stop Rainbow Chat", posY, function()
        local ChatWindowConfig = game:GetService("TextChatService"):FindFirstChild("ChatWindowConfiguration")
        if ChatWindowConfig then
            ChatWindowConfig.BackgroundColor3 = Color3.new(0, 0, 0)
            ChatWindowConfig.TextColor3 = Color3.new(1, 1, 1)
        end
    end)
end

-- Workspace tab content (Particle Spam, Decal Spam, Delete Terrain)
local function setupWorkspaceTab(panel)
    local posY = 20
    createButton(panel, "Particle Spam", posY, particleSpam)
    posY = posY + 50
    createButton(panel, "Decal Spammer", posY, decalSpam)
    posY = posY + 50
    createButton(panel, "Delete Terrain", posY, deleteTerrain)
end

-- Skybox tab content
local function setupSkyboxTab(panel)
    local posY = 20
    createButton(panel, "Set Skybox", posY, setSkybox)
end

-- UPDATE CONTENT PANEL BASED ON SELECTED TAB
function updateContentForTab(tabName)
    hideAllContent()
    if ContentPanels[tabName] then
        ContentPanels[tabName].Visible = true
    end
end

-- Initialize Tabs content once
setupSpamStuffTab(ContentPanels["SpamStuff"])
setupPlayersTab(ContentPanels["Players"])
setupChatEffectsTab(ContentPanels["ChatEffects"])
setupWorkspaceTab(ContentPanels["Workspace"])
setupSkyboxTab(ContentPanels["Skybox"])

-- Select first tab by default
TabButtons["SpamStuff"].BackgroundColor3 = Color3.fromRGB(150, 100, 220)
TabButtons["SpamStuff"].TextColor3 = Color3.fromRGB(255, 255, 255)
CurrentTab = "SpamStuff"
TitleLabel.Text = "USER'S SS - SpamStuff"
updateContentForTab(CurrentTab)
